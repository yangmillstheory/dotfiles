#!/usr/bin/env zsh

if [[ $1 =~ /google/src/cloud/[^/]+/(.+)/google3(.*)$ ]]; then
  echo "(${match[1]}) //${match[2]#/}"
elif [[ $1 =~ ^(.*)+(genfiles|bin|testlogs)/(.*)$  ]]; then
  BUILD_INFO=$(dirname "${match[1]}")/build-info.txt
	G3_ROOT=$(grep BUILD_DIRECTORY $BUILD_INFO | cut -d ' ' -f 2)
  WS_NAME=$(basename $(dirname $G3_ROOT))
	echo "($WS_NAME:blaze-${match[2]}) ${match[3]}"
else
  plugins=(shrink-path)
  source $ZSH/oh-my-zsh.sh && shrink_path -f $1
fi
